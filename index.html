<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gia Ph·∫£ H·ªç Nguy·ªÖn</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Times New Roman', serif;
            background: #f5e6d3;
            overflow-x: auto;
            min-height: 100vh;
        }
        
        .container {
            position: relative;
            min-width: 1600px;
            padding: 20px;
        }
        
        /* Header v·ªõi r·ªìng v√† t√™n d√≤ng h·ªç */
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .header-banner {
            display: inline-block;
            background: linear-gradient(to bottom, #d4af37, #f4e4c1);
            border: 3px solid #8B4513;
            border-radius: 20px;
            padding: 15px 60px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .header-banner::before,
        .header-banner::after {
            content: 'üêâ';
            position: absolute;
            font-size: 60px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .header-banner::before {
            left: -80px;
        }
        
        .header-banner::after {
            right: -80px;
        }
        
        .gia-pha-title {
            font-size: 32px;
            font-weight: bold;
            color: #8B0000;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 5px;
        }
        
        .family-name {
            font-size: 24px;
            font-weight: bold;
            color: #2C1810;
        }
        
        /* C√¢u ƒë·ªëi 2 b√™n */
        .side-text {
            position: fixed;
            writing-mode: vertical-rl;
            font-size: 28px;
            font-weight: bold;
            color: #8B0000;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .side-text.left {
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .side-text.right {
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        /* SVG Container */
        .tree-svg {
            display: block;
            margin: 0 auto;
        }
        
        /* Th·∫ª ng∆∞·ªùi */
        .person-card {
            width: 80px;
            height: 100px;
        }
        
        .card-bg {
            fill: #f4e4a8;
            stroke: #8B4513;
            stroke-width: 2;
        }
        
        .card-photo {
            fill: #ddd;
            stroke: #666;
            stroke-width: 1;
        }
        
        .card-name {
            font-size: 10px;
            font-weight: bold;
            fill: #2C1810;
            text-anchor: middle;
        }
        
        .card-info {
            font-size: 8px;
            fill: #666;
            text-anchor: middle;
        }
        
        /* ƒê∆∞·ªùng n·ªëi */
        .connection-line {
            stroke: #000;
            stroke-width: 2;
            fill: none;
        }
        
        /* Zoom controls */
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            background: white;
            border: 2px solid #8B4513;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: #f4e4a8;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="side-text left">C·∫ßn C·∫ßn ChƒÉng ƒê·ª©c Truy·ªÅn Nh√¢n Thinh</div>
    <div class="side-text right">Hi·∫øu Hi·∫øu T√≠n T√≠n H·∫≠u V√£n ƒê·∫°i Vinh</div>
    
    <div class="controls">
        <button class="control-btn" onclick="zoomIn()">+</button>
        <button class="control-btn" onclick="zoomOut()">‚àí</button>
        <button class="control-btn" onclick="resetView()" title="Reset">‚ü≤</button>
    </div>
    
    <div class="container">
        <div class="header">
            <div class="header-banner">
                <div class="gia-pha-title">GIA PH·∫¢</div>
                <div class="family-name">H·ªå NGUY·ªÑN</div>
            </div>
        </div>
        
        <svg id="treeSvg" class="tree-svg" width="1600" height="1200">
            <defs>
                <pattern id="avatar" patternUnits="userSpaceOnUse" width="40" height="40">
                    <circle cx="20" cy="20" r="18" fill="#bbb"/>
                    <circle cx="20" cy="15" r="8" fill="#999"/>
                    <ellipse cx="20" cy="35" rx="12" ry="8" fill="#999"/>
                </pattern>
            </defs>
        </svg>
    </div>

    <script>
        const familyData = {
            id: 1,
            name: "Nguy·ªÖn VƒÉn An",
            birth: "1900",
            death: "1975",
            gender: "male",
            spouse: {
                name: "Tr·∫ßn Th·ªã B√¨nh",
                birth: "1905",
                death: "1980",
                gender: "female"
            },
            children: [
                {
                    id: 2,
                    name: "Nguy·ªÖn V. C∆∞·ªùng",
                    birth: "1925",
                    gender: "male",
                    spouse: {
                        name: "L√™ T. Dung",
                        birth: "1928",
                        gender: "female"
                    },
                    children: [
                        {
                            id: 5,
                            name: "Nguy·ªÖn V. H√πng",
                            birth: "1950",
                            gender: "male",
                            spouse: {
                                name: "Ph·∫°m T. Lan",
                                birth: "1953",
                                gender: "female"
                            },
                            children: [
                                {
                                    id: 10,
                                    name: "Nguy·ªÖn M. Tu·∫•n",
                                    birth: "1975",
                                    gender: "male",
                                    spouse: {
                                        name: "V≈© Thu H√†",
                                        birth: "1978",
                                        gender: "female"
                                    },
                                    children: [
                                        { id: 15, name: "Nguy·ªÖn ƒê. Anh", birth: "2000", gender: "male" },
                                        { id: 16, name: "Nguy·ªÖn T. Trang", birth: "2003", gender: "female" }
                                    ]
                                },
                                { id: 11, name: "Nguy·ªÖn T. H∆∞∆°ng", birth: "1978", gender: "female" }
                            ]
                        },
                        { id: 6, name: "Nguy·ªÖn T. Mai", birth: "1953", gender: "female" }
                    ]
                },
                {
                    id: 3,
                    name: "Nguy·ªÖn V. ƒê·ª©c",
                    birth: "1928",
                    gender: "male",
                    spouse: {
                        name: "Ho√†ng T. Em",
                        birth: "1930",
                        gender: "female"
                    },
                    children: [
                        {
                            id: 7,
                            name: "Nguy·ªÖn V. Ki√™n",
                            birth: "1955",
                            gender: "male",
                            spouse: {
                                name: "ƒê·ªó T. Nga",
                                birth: "1957",
                                gender: "female"
                            },
                            children: [
                                {
                                    id: 12,
                                    name: "Nguy·ªÖn Q. B·∫£o",
                                    birth: "1980",
                                    gender: "male",
                                    spouse: {
                                        name: "L√Ω T. H·∫±ng",
                                        birth: "1982",
                                        gender: "female"
                                    },
                                    children: [
                                        { id: 17, name: "Nguy·ªÖn M. Khang", birth: "2005", gender: "male" },
                                        { id: 18, name: "Nguy·ªÖn B. Ch√¢u", birth: "2008", gender: "female" }
                                    ]
                                },
                                { id: 13, name: "Nguy·ªÖn T. Linh", birth: "1983", gender: "female" }
                            ]
                        }
                    ]
                },
                { id: 4, name: "Nguy·ªÖn T. Ph∆∞∆°ng", birth: "1932", gender: "female" }
            ]
        };

        const svg = document.getElementById('treeSvg');
        const cardWidth = 80;
        const cardHeight = 100;
        const spouseGap = 10;
        const levelGap = 130;
        const siblingGap = 30;
        let scale = 1;
        let translateX = 0;
        let translateY = 0;

        function drawCard(x, y, person) {
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            
            // Background
            const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            rect.setAttribute('x', x);
            rect.setAttribute('y', y);
            rect.setAttribute('width', cardWidth);
            rect.setAttribute('height', cardHeight);
            rect.setAttribute('rx', '5');
            rect.setAttribute('class', 'card-bg');
            g.appendChild(rect);
            
            // Photo placeholder
            const photo = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            photo.setAttribute('x', x + 20);
            photo.setAttribute('y', y + 10);
            photo.setAttribute('width', '40');
            photo.setAttribute('height', '40');
            photo.setAttribute('rx', '3');
            photo.setAttribute('class', 'card-photo');
            photo.setAttribute('fill', 'url(#avatar)');
            g.appendChild(photo);
            
            // Name
            const name = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            name.setAttribute('x', x + cardWidth/2);
            name.setAttribute('y', y + 65);
            name.setAttribute('class', 'card-name');
            name.textContent = person.name;
            g.appendChild(name);
            
            // Birth year
            const birth = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            birth.setAttribute('x', x + cardWidth/2);
            birth.setAttribute('y', y + 77);
            birth.setAttribute('class', 'card-info');
            birth.textContent = person.birth;
            g.appendChild(birth);
            
            // Gender
            const gender = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            gender.setAttribute('x', x + cardWidth/2);
            gender.setAttribute('y', y + 88);
            gender.setAttribute('class', 'card-info');
            gender.textContent = person.gender === 'male' ? '‚ôÇ Nam' : '‚ôÄ N·ªØ';
            g.appendChild(gender);
            
            return g;
        }

        function drawLine(x1, y1, x2, y2) {
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', x1);
            line.setAttribute('y1', y1);
            line.setAttribute('x2', x2);
            line.setAttribute('y2', y2);
            line.setAttribute('class', 'connection-line');
            return line;
        }

        function drawPath(d) {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.setAttribute('d', d);
            path.setAttribute('class', 'connection-line');
            return path;
        }

        function calculateWidth(node) {
            if (!node) return cardWidth;
            
            let width = cardWidth;
            if (node.spouse) width += cardWidth + spouseGap;
            
            if (node.children && node.children.length > 0) {
                const childrenWidth = node.children.reduce((sum, child, idx) => {
                    return sum + calculateWidth(child) + (idx < node.children.length - 1 ? siblingGap : 0);
                }, 0);
                width = Math.max(width, childrenWidth);
            }
            
            return width;
        }

        function drawTree(node, x, y, isRoot = false) {
            if (!node) return;
            
            const nodeWidth = calculateWidth(node);
            const hasSpouse = !!node.spouse;
            const coupleWidth = hasSpouse ? cardWidth * 2 + spouseGap : cardWidth;
            
            // V·∫Ω th·∫ª ng∆∞·ªùi ch√≠nh
            const personX = x + (nodeWidth - coupleWidth) / 2;
            svg.appendChild(drawCard(personX, y, node));
            
            // V·∫Ω th·∫ª v·ª£/ch·ªìng
            if (hasSpouse) {
                svg.appendChild(drawCard(personX + cardWidth + spouseGap, y, node.spouse));
                // ƒê∆∞·ªùng n·ªëi v·ª£ ch·ªìng
                svg.appendChild(drawLine(
                    personX + cardWidth, y + cardHeight/2,
                    personX + cardWidth + spouseGap, y + cardHeight/2
                ));
            }
            
            // V·∫Ω con c√°i
            if (node.children && node.children.length > 0) {
                const coupleCenterX = personX + coupleWidth / 2;
                const childrenY = y + levelGap;
                
                // ƒê∆∞·ªùng d·ªçc t·ª´ cha m·∫π xu·ªëng
                const verticalStartY = y + cardHeight;
                const verticalMidY = y + cardHeight + 30;
                svg.appendChild(drawLine(coupleCenterX, verticalStartY, coupleCenterX, verticalMidY));
                
                // T√≠nh t·ªïng width c·ªßa children
                let totalChildrenWidth = 0;
                node.children.forEach((child, idx) => {
                    totalChildrenWidth += calculateWidth(child);
                    if (idx < node.children.length - 1) totalChildrenWidth += siblingGap;
                });
                
                let childX = x + (nodeWidth - totalChildrenWidth) / 2;
                const childCenters = [];
                
                // V·∫Ω t·ª´ng con
                node.children.forEach((child, idx) => {
                    const childWidth = calculateWidth(child);
                    const childCoupleWidth = child.spouse ? cardWidth * 2 + spouseGap : cardWidth;
                    const childCenterX = childX + childWidth / 2;
                    childCenters.push(childCenterX);
                    
                    drawTree(child, childX, childrenY);
                    childX += childWidth + siblingGap;
                });
                
                // ƒê∆∞·ªùng ngang n·ªëi c√°c con
                if (node.children.length > 1) {
                    const firstChildCenter = childCenters[0];
                    const lastChildCenter = childCenters[childCenters.length - 1];
                    svg.appendChild(drawLine(firstChildCenter, verticalMidY, lastChildCenter, verticalMidY));
                }
                
                // ƒê∆∞·ªùng d·ªçc t·ª´ ngang xu·ªëng m·ªói con
                childCenters.forEach(centerX => {
                    svg.appendChild(drawLine(centerX, verticalMidY, centerX, childrenY));
                });
            }
        }

        function render() {
            svg.innerHTML = svg.innerHTML.split('</defs>')[0] + '</defs>';
            const totalWidth = calculateWidth(familyData);
            const startX = (1600 - totalWidth) / 2;
            drawTree(familyData, startX, 50, true);
        }

        function zoomIn() {
            scale *= 1.2;
            updateTransform();
        }

        function zoomOut() {
            scale /= 1.2;
            updateTransform();
        }

        function resetView() {
            scale = 1;
            translateX = 0;
            translateY = 0;
            updateTransform();
        }

        function updateTransform() {
            svg.style.transform = `scale(${scale}) translate(${translateX}px, ${translateY}px)`;
        }

        // Drag to pan
        let isDragging = false;
        let startX, startY;

        svg.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
            svg.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            svg.style.cursor = 'grab';
        });

        svg.style.cursor = 'grab';
        render();
    </script>
</body>
</html>
